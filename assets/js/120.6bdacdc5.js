(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{876:function(t,s,a){"use strict";a.r(s);var e=a(67),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"eureka-自我保护"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eureka-自我保护"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Eureka 自我保护")])]),t._v(" "),a("h2",{attrs:{id:"故障现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#故障现象"}},[t._v("#")]),t._v(" "),a("strong",[t._v("故障现象")])]),t._v(" "),a("hr"),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/assets/spring-cloud-2/C-module/yky-2020-08-17-164008.png",alt:"故障现象"}})]),t._v(" "),a("h2",{attrs:{id:"导致原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导致原因"}},[t._v("#")]),t._v(" "),a("strong",[t._v("导致原因")])]),t._v(" "),a("hr"),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/assets/spring-cloud-2/C-module/yky-2020-08-17-164929.png",alt:"导致原因1"}}),t._v(" "),a("img",{attrs:{src:"/docs/assets/spring-cloud-2/C-module/yky-2020-08-17-165540.png",alt:"导致原因2"}})]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("一句话：某时刻某一个微服务不可用了，Eureka不会立刻清理，依旧会对该微服务的信息进行保存")]),t._v(" "),a("p",[t._v("属于CAP里面的AP分支")])]),t._v(" "),a("h2",{attrs:{id:"怎么禁止自我保护（一般生产环境中不会禁止自我保护）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么禁止自我保护（一般生产环境中不会禁止自我保护）"}},[t._v("#")]),t._v(" "),a("strong",[t._v("怎么禁止自我保护（一般生产环境中不会禁止自我保护）")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"注册中心-eureakeserver-端-7001"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注册中心-eureakeserver-端-7001"}},[t._v("#")]),t._v(" "),a("strong",[t._v("注册中心 eureakeServer 端 7001")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("出厂默认，自我保护机制是开启的")])])]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("eureka")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭自我保护机制，保证不可用服务被及时清除")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enable-self-preservation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 时间间隔")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("eviction-interval-timer-in-ms")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[a("strong",[t._v("使用 "),a("code",[t._v("eureka.server.enable-self-preservation = false")]),t._v(" 可以禁用自我保护模式")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("关闭效果")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("在eurekaServer端7001处设置关闭自我保护机制")])])])]),t._v(" "),a("h3",{attrs:{id:"生产者客户端-eureakeclient-端8001"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产者客户端-eureakeclient-端8001"}},[t._v("#")]),t._v(" "),a("strong",[t._v("生产者客户端 eureakeClient 端8001")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("默认")])])]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("eureka")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("instance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Eureka 客户端向服务端发送心跳的时间间隔,单位为秒(默认是30秒)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("lease-renewal-interval-in-seconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Eureka 服务端在收到最后一次心跳后等待时间上限,单位为秒(默认是90秒)，超时将剔除服务")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("lease-expiration-duration-in-seconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("strong",[t._v("配置")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/assets/spring-cloud-2/C-module/yky-2020-08-17-201922.png",alt:"配置"}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("strong",[t._v("测试")])])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("7001和8001都配置完成")])]),t._v(" "),a("li",[a("strong",[t._v("先启动7001再启动8001")])]),t._v(" "),a("li",[a("strong",[t._v("先关闭8001")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("马上被删除了")])])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);